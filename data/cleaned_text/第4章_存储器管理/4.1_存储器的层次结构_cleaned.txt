计算机操作系统第四章存储器管理9999999999999999存储器历来都是计算机系统的重要组成部分。近年来，随着计算机技术的发展，系统软件和应用软件在种类、功能上都急剧地膨胀，虽然存储器容量一直在不断扩大，但仍不能满足现代软件发展的需要。因此，存储器仍然是一种宝贵而又稀缺的资源。如何对它加以有效的管理，不仅直接影响到存储器的利用率，而且对系统性能也有重大影响。存储器管理的主要对象是内存。由于对外存的管理与对内存的管理相类似，只是它们的用途不同，即外存主要用来存放文件，所以我们把对外存的管理放在文件管理一章介绍。
4.1存储器的层次结构在计算机执行时，几乎每一条指令都涉及对存储器的访问，因此要求对存储器的访问速度能跟得上处理机的运行速度。或者说，存储器的速度必须非常快，能与处理机的速度相匹配，否则会明显地影响到处理机的运行。此外还要求存储器具有非常大的容量，而且存储器的价格还应很便宜。对于这样十分严格的三个条件，目前是无法同时满足的。于是在现代计算机系统中都无一例外地采用了多层结构的存储器系统。
4.1.1多层结构的存储器系统1.存储器的多层结构对于通用计算机而言，存储层次至少应具有三级：最高层为CPU寄存器，中间为主存，最底层是辅存。在较高档的计算机中，还可以根据具体的功能细分为寄存器、高速缓存、主存储器、磁盘缓存、固定磁盘、可移动存储介质等6层。如图4-1所示。在存储CPU寄存器{寄存器层次中，层次越高（越靠近CPU)，存储介高速缓存质的访问速度越快，价格也越高，相对所主存主存储器配置的存储容量也越小。其中，寄存器、磁盘缓存高速缓存、主存储器和磁盘缓存均属于操固定磁盘辅存作系统存储管理的管辖范畴，掉电后它们可移动存储介质中存储的信息不再存在。而低层的固定磁盘和可移动存储介质则属于设备管理的管图4-1计算机系统存储层次示意辖范畴，它们存储的信息将被长期保存。
120第四章存储器管理2.可执行存储器在计算机系统的存储层次中，寄存器和主存储器又被称为可执行存储器。对于存放于其中的信息，与存放于辅存中的信息相比较而言，计算机所采用的访问机制是不同的，所需耗费的时间也是不同的。进程可以在很少的时钟周期内使用一条load或store指令对可执行存储器进行访问。但对辅存的访问则需要通过IO设备实现，因此，在访问中将涉及到中断、设备驱动程序以及物理设备的运行，所需耗费的时间远远高于访问可执行存储器的时间，一般相差3个数量级甚至更多。
对于不同层次的存储介质，由操作系统进行统一管理。操作系统的存储管理负责对可执行存储器的分配、回收，以及提供在存储层次间数据移动的管理机制，例如主存与磁盘缓存、高速缓存与主存间的数据移动等。而设备和文件管理则根据用户的需求，提供对辅存的管理机制。本章主要讨论有关存储管理部分的内容，对于辅存部分，则放在以后的章节中进行介绍。
4.1.2主存储器与寄存器1.主存储器和数据，也称可执行存储器。通常，处理机都是从主存储器中取得指令和数据的，并将其所取得的指令放入指令寄存器中，而将其所读取的数据装入到数据寄存器中；或者反之，将寄存器中的数据存入到主存储器。早期的内存是由磁芯做成的，其容量一般为数十KB到数百KB。随着VLSI的发展，现在的内存已由VLSI构成，其容量，即使是微机系统，MB。CPU与外围设备交换的信息一般也依托于主存储器的地址空间。由于主存储器访问速度远低于CPU执行指令的速度，为缓和这一矛盾，在计算机系统中引I入了寄存器和高速缓存。
2.寄存器寄存器具有与处理机相同的速度，故对寄存器的访问速度最快，完全能与CPU协调工作，但价格却十分昂贵，因此容量不可能做得很大。在早期计算机中，寄存器的数目仅为几个，主要用于存放处理机运行时的数据，以加速存储器的访问速度，如使用寄存器存放操作数，或用作地址寄存器加快地址转换速度等。随着VLSI的发展，寄存器的成本也在迅速降低，在当前的微机系统和大中型机中，寄存器的数目都已增加到数十个到数百个，而寄存器的字长一般是32位或64位；而在小型的嵌入式计算机中，寄存器的数目仍只有几个到十几个，而且寄存器的字长通常只有8位。
4.1.3高速缓存和磁盘缓存1.高速缓存高速缓存是现代计算机结构中的一个重要部件，它是介于寄存器和存储器之间的存储器，主要用于备份主存中较常用的数据，以减少处理机对主存储器的访问次数，这样可大121
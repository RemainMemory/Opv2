1.4操作系统的主要功能 

引入OS的主要目的是，为多道程序的运行提供良好的运行环境，以保证多道程序能 有条不紊地、高效地运行，并能最大程度地提高系统中各种资源的利用率，方便用户的使 用。为此，在传统的OS中应具有处理机管理、存储器管理、设备管理和文件管理等基本 功能。此外，为了方便用户使用OS，还需向用户提供方便的用户接口。

1.4.1处理机管理功能 

在传统的多道程序系统中，处理机的分配和运行都是以进程为基本单位的，因而对处 理机的管理可归结为对进程的管理。处理机管理的主要功能有：创建和撤消进程，对诸进 程的运行进行协调，实现进程之间的信息交换，以及按照一定的算法把处理机分配给进程。

1.进程控制 

在多道程序环境下为使作业能并发执行，必须为每道作业创建一个或几个进程，并为 之分配必要的资源。当进程运行结束时，应立即撤消该进程，以便能及时回收该进程所占 用的各类资源，供其它进程使用。在设置有线程的OS中，进程控制还应包括为一个进程 创建若干个线程，以提高系统的并发性。因此，进程控制的主要功能也就是为作业创建进 程、撤消（终止)已结束的进程，以及控制进程在运行过程中的状态转换。

2.进程同步 

为使多个进程能有条不紊地运行，系统中必须设置相应的进程同步机制。该机制的主 要任务是为多个进程（含线程）的运行进行协调。常用的协调方式有两种：①进程互斥方式， 这是指诸进程在对临界资源进行访问时，应采用互斥方式；②进程同步方式，指在相互合 作去完成共同任务的诸进程间，由同步机构对它们的执行次序加以协调。最简单的用于实 16  第一章操作系统引论 现进程互斥的机制是为每一个临界资源配置一把锁W，当锁打开时，进程可以对该临界资 源进行访问；而当锁关上时，则禁止进程访问该临界资源。而实现进程同步时，最常用的 机制是信号量机制。

3.进程通信 

当有一组相互合作的进程去完成一个共同的任务时，在它们之间往往需要交换信息。 例如，有输入进程、计算进程和打印进程三个相互合作的进程，输入进程负责将所输入的 数据传送给计算进程；计算进程利用输入数据进行计算，并把计算结果传送给打印进程； 最后由打印进程把计算结果打印出来。进程通信的任务是实现相互合作进程之间的信息交换。 当相互合作的进程处于同一计算机系统时，通常在它们之间采用直接通信方式，即由 源进程利用发送命令直接将消息(message)挂到目标进程的消息队列上，以后由目标进程利 用接收命令从其消息队列中取出消息。

4.调度 

在传统OS中，调度包括作业调度和进程调度两步。

（1）作业调度。作业调度的基本任务是从后备队列中按照一定的算法选择出若干个作 业，为它们分配运行所需的资源，在将这些作业调入内存后，分别为它们建立进程，使它 们都成为可能获得处理机的就绪进程，并将它们插入就绪队列中。

（2）进程调度。进程调度的任务是从进程的就绪队列中按照一定的算法选出一个进程， 将处理机分配给它，并为它设置运行现场，使其投入执行。

1.4.2存储器管理功能

存储器管理的主要任务，是为多道程序的运行提供良好的环境，提高存储器的利用率， 方便用户使用，并能从逻辑上扩充内存。为此，存储器管理应具有内存分配和回收、内存 保护、地址映射和内存扩充等功能。

1.内存分配 

内存分配的主要任务是：

（1）为每道程序分配内存空间，使它们“各得其所”。

(2）提高存储器的利用率，尽量减少不可用的内存空间（碎片)。

(3）允许正在运行的程序申请附加的内存空间，以适应程序和数据动态增长的需要。 OS在实现内存分配时，可采取静态和动态两种方式：

（1）静态分配方式。每个作业的内存空间是在作业装入时确定的，在作业装入后的整

(2）动态分配方式。每个作业所要求的基本内存空间虽然也是在装入时确定的，但允 许作业在运行过程中继续申请新的附加内存空间，以适应程序和数据的动态增长，也允许 作业在内存中“移动”。

2.内存保护 

不干扰绝不充许用户程序访问操作系统的程序和数据，也不允许用户程序转移到非共 享的其它用户程序中去执行。 17  计算机操作系统 为了确保每道程序都只在自己的内存区中运行，必须设置内存保护机制。一种比较简 单的内存保护机制是设置两个界限寄存器，分别用于存放正在执行程序的上界和下界。在 程序运行时，系统须对每条指令所要访问的地址进行检查，如果发生越界，便发出越界中 断请求，以停止该程序的执行。

3.地址映射 

在多道程序环境下，由于每道程序经编译和链接后所形成的可装入程序其地址都是从 0开始的，但不可能将它们从“0”地址（物理）开始装入内存，致使（各程序段的）地址空间内 的逻辑地址与其在内存空间中的物理地址并不相一致。为保证程序能正确运行，存储器管 理必须提供地址映射功能，即能够将地址空间中的逻辑地址转换为内存空间中与之对应的 物理地址。该功能应在硬件的支持下完成。

4.内存扩充 

内存扩充并非是从物理上去扩大内存的容量，而是借助于虚拟存储技术，从逻辑上扩 充内存容量，使用户所感觉到的内存容量比实际内存容量大得多，以便让更多的用户程序 能并发运行。这样既满足了用户的需要，又改善了系统的性能。为了能在逻辑上扩充内存， 系统必须设置内存扩充机制（包含少量的硬件)，用于实现下述各功能：

（1）请求调入功能，系统允许在仅装入部分用户程序和数据的情况下，便能启动该程 OS发出请求，由OS从磁盘中将所需部分调入内存，以便继续运行。

(2）置换功能，若发现在内存中已无足够的空间来装入需要调入的程序和数据时，系 统应能将内存中的一部分暂时不用的程序和数据调至硬盘上，以腾出内存空间，然后再将 所需调入的部分装入内存。

1.4.3设备管理功能 

设备管理的主要任务如下操作

(2）提高CPU和I/O设备的利用率，提高I/O速度，方便用户使用I/O设备。 为实现上述任务，设备管理应具有缓冲管理、设备分配和设备处理以及虚拟设备等功能。

1.缓冲管理 

如果在IO设备和CPU之间引I入缓冲，则可有效地缓和CPU和IO设备速度不匹配的 矛盾，提高CPU的利用率，进而提高系统吞吐量。因此在现代OS中，无一例外地在内存 中设置了缓冲区，而且还可通过增加缓冲区容量的方法来改善系统的性能。不同的系统可 采用不同的缓冲区机制。最常见的缓冲区机制有：单缓冲机制、能实现双向同时传送数据 的双缓冲机制、能供多个设备同时使用的公用缓冲池机制。上述这些缓冲区都由OS缓冲 管理机制将它们管理起来。

2.设备分配 

设备分配的基本任务是根据用户进程的I/O请求、系统现有资源情况以及按照某种设 备分配策略，为之分配其所需的设备。如果在IO设备和CPU之间还存在着设备控制器和 18  第一章操作系统引论 I/O通道，则还需为分配出去的设备分配相应的控制器和通道。为实现设备分配，系统中应 设置设备控制表、控制器控制表等数据结构，用于记录设备及控制器等的标识符和状态。 根据这些表格可以了解指定设备当前是否可用，是否忙碌，以供进行设备分配时参考。在 进行设备分配时，应针对不同的设备类型而采用不同的设备分配方式。对于独占设备的分 配还应考虑到该设备被分配出去后系统是否安全。在设备使用完后，应立即由系统回收。

3.设备处理 

设备处理程序又称为设备驱动程序。其基本任务是用于实现CPU和设备控制器之间的 通信，即由CPU向设备控制器发出IO命令，要求它完成指定的IVO操作；反之，由CPU 接收从控制器发来的中断请求，并给予迅速的响应和相应的处理。 设备处理过程是：首先检查I/O请求的合法性，了解设备状态是否是空闲的，读取有 关的传递参数及设置设备的工作方式。然后向设备控制器发出I/O命令，启动IO设备完 该中断请求的类型，调用相应的中断处理程序进行处理。对于设置了通道的计算机系统， 设备处理程序还应能根据用户的I/O请求自动地构成通道程序。

1.4.4文件管理功能

文件管理的主要任务是对用户文件和系统文件进行管理以方便用户使用，并保证文件 的安全性。为此，文件管理应具有对文件存储空间的管理、目录管理、文件的读/写管理以 及文件的共享与保护等功能。

1.文件存储空间的管理 

在多用户环境下，若由用户自己对文件的存储进行管理，不仅非常困难，而且也必然 十分低效。因而需要由文件系统对诸多文件及文件的存储空间实施统一的管理。其主要任 务是：为每个文件分配必要的外存空间，提高外存的利用率，进而提高文件系统的存、取 速度。为此，系统中应设置相应的数据结构，用于记录文件存储空间的使用情况，以供分 配存储空间时参考。还应具有对存储空间进行分配和回收的功能。

2.目录管理 

目录管理的主要任务是为每个文件建立一个目录项，目录项包括文件名、文件属性、 文件在磁盘上的物理位置等，并对众多的目录项加以有效的组织，以实现方便的按名存取。 即用户只需提供文件名，即可对该文件进行存取。目录管理还应能实现文件共享，这样， 只需在外存上保留一份该共享文件的副本。此外，还应能提供快速的目录查询手段，以提 高对文件检索的速度。

3.文件的读/写管理和保护

(1）文件的读/写管理。该功能是根据用户的请求，从外存中读取数据，或将数据写入 外存。在进行文件读/写时，系统先根据用户给出的文件名去检索文件目录，从中获得文件在 外存中的位置。然后，利用文件读/写指针，对文件进行读/写。一旦读/写完成，便修改读/

(2）文件保护。为了防止系统中的文件被非法窃取和破坏，在文件系统中必须提供有 效的存取控制功能，以实现下述目标：①防止未经核准的用户存取文件；②防止冒名顶 19  计算机操作系统 替存取文件；③防止以不正确的方式使用文件。

1.4.5操作系统与用户之间的接口 

为了方便用户对操作系统的使用，操作系统向用户提供了“用户与操作系统的接口”。 该接口通常可分为如下两大类：

1.用户接口 

为了便于用户直接或间接地控制自己的作业，操作系统向用户提供了命令接口。用户 可通过该接口向作业发出命令以控制作业的运行。该接口又进一步分为联机用户接口、脱 机用户接口和图形用户接口三种。

（1）联机用户接口。这是为联机用户提供的，它由一组键盘操作命令及命令解释程序 组成。当用户在终端或控制台上键入一条命令后，系统便立即转入命令解释程序，对该命 令加以解释执行。在完成指定功能后系统又返回到终端或控制台上，等待用户键入下一条 命令。这样，用户便可通过先后键入不同命令的方式来实现对作业的控制，直至作业完成。

(2）脱机用户接口。这是为批处理作业的用户提供的。用户用作业控制语言JCL把需 要对作业进行的控制和干预的命令事先写在作业说明书上，然后将它与作业一起提供给系 统。当系统调度到该作业运行时，通过调用命令解释程序去对作业说明书上的命令逐条解 释执行，直至遇到作业结束语句时系统才停止该作业的运行。

（3）图形用户接口。通过联机用户接口取得OS的服务既不方便又花时间，用户必须熟 记所有命令及其格式和参数，并逐个字符地键入命令，于是图形用户接口便应运而生。图 形用户接口采用了图形化的操作界面，用非常容易识别的各种图标（icon）来将系统的各项功 能、各种应用程序和文件直观、逼真地表示出来。用户可通过菜单（和对话框）用移动鼠标 选择菜单项的方式取代命令的键入，以方便、快捷地完成对应用程序和文件的操作，从而 把用户从繁琐且单调的操作中解脱出来。

2.程序接口 

程序接口是为用户程序在执行中访问系统资源而设置的，是用户程序取得操作系统服 务的唯一途径。它是由一组系统调用组成的，每一个系统调用都是一个能完成特定功能的 子程序。每当应用程序要求OS提供某种服务（功能）时，便调用具有相应功能的系统调用（子 程序）。早期的系统调用都是用汇编语言提供的，只有在用汇编语言书写的程序中才能直接 这样，应用程序便可通过调用对应的库函数来使用系统调用。但在近几年所推出的操作系 统中，如UNIX、OS/2版本中，其系统调用本身已经采用C语言编写，并以函数形式提供， 故在用C语言编制的程序中，可直接使用系统调用。

1.4.6现代操作系统的新功能 

现代操作系统是在传统操作系统基础上发展起来的，它除了具有传统操作系统的功能 外，还增加了面向安全、面向网络和面向多媒体等功能。

1.系统安全 

通常，政府机关和企事业单位有大量的、重要的信息，必须高度集中地存储在计算机 20  系统中。这样，如何确保在计算机系统中存储和传输数据的保密性、完整性和系统可用性， 便成为信息系统函待解决的重要问题，而保障系统安全性的任务也责无旁贷地落到了现代 OS的身上。 络的普及，传统的安全措施已远不能满足要求。为此，在现代OS中采取了多种有效措施 来确保系统的安全。在本书中我们仅局限于介绍保障系统安全的几个技术问题，包括：

（1）认证技术。这是一个用来确认被认证的对象是否名副其实的过程，以确定对象的 真实性，防止入侵者进行假冒和篡改等。如身份认证，是通过验证被认证对象的一个或多 个参数的真实性和有效性来确定被认证对象是否名副其实；因此，在被认证对象与要验证 的那些参数之间应存在严格的对应关系。

(2）密码技术。即对系统中所需存储和传输的数据进行加密，使之成为密文，这样， 攻击者即使截获到数据，也无法了解到数据的内容。只有指定的用户才能对该数据予以解 密，了解其内容，从而有效地保护了系统中信息资源的安全性。近年来，国内外广泛应用 数据加密技术来保障计算机系统的安全性。

（3）访问控制技术，可通过两种途径来保障系统中资源的安全：①）通过对用户存取权 限的设置，可以限定用户只能访问被允许访问的资源，这样也就限定了用户对系统资源的 访问范围；②访问控制还可以通过对文件属性的设置来保障指定文件的安全性，如设置文 件属性为只读时，该文件就只能被读而不能被修改等。

(4）反病毒技术。对于病毒的威胁，最好的解决方法是预防，不让病毒侵入系统，但 要完全做到这一点是十分困难的，因此还需要非常有效的反病毒软件来检测病毒。在反病 毒软件被安装到计算机后，便可对硬盘上所有的可执行文件进行扫描，检查盘上的所有可 执行文件，若发现有病毒，便立即将它清除。

2.网络的功能和服务 

在现代OS中，为支持用户联网取得各类网络所提供的服务，如电子邮件服务、Web 服务等，应在操作系统中增加面向网络的功能，用于实现网络通信和资源管理，以及提供 用户取得网络服务的手段。作为一个网络操作系统，应当具备多方面的功能：

（1）网络通信，用于在源主机和目标主机之间，实现无差错的数据传输，如建立和拆 除通信链路、传输控制、差错控制和流量控制等。

(2）资源管理，即对网络中的共享资源（硬件和软件）实施有效的管理，协调诸用户对共 享资源的使用，保证数据的安全性和一致性。典型的共享硬件资源有硬盘、打印机等，软 件资源有文件和数据。

(3）应用互操作，即在一个由若干个不同网络互连所构成的互连网络中，必须提供应 用互操作功能，以实现信息的互通性和信息的互用性。信息的互通性是指在不同网络中的 用户之间，能实现信息的互通。信息的互用性是表示用户可以访问不同网络中的文件系统 和数据库系统中的信息。

3.支持多媒体 

一个支持多媒体的操作系统必须能像一般OS处理文字、图形信息那样去处理音频和 视频信息等多媒体信息，为此，现代操作系统增加了多媒体的处理功能： 21  计算机操作系统

(1）接纳控制功能。在多媒体系统中，为了保证同时运行多个实时进程的截止时间， 需要对在系统中运行的软实时任务，即SRT任务的数目、驻留在内存中的任务数目加以限 制，为此设置了相应的接纳控制功能，如媒体服务器的接纳控制、存储器接纳控制和进程 接纳控制。

(2）实时调度。多媒体系统中的每一个任务，往往都是一些要求较严格的、周期性的 软实时任务SRT，如为了保证动态图像的连续性，图像更新的周期必须在 40 ms 之内，因 此在SRT调度时，不仅需要考虑进程的调度策略，还要考虑进程调度的接纳度等，相比传 统的OS这就要复杂得多。

(3）多媒体文件的存储。为了存放多媒体文件，对OS最重要的要求是能把硬盘上的数 据快速地传送到输出设备上。因此，对于在传统文件系统中数据的离散存放方式以及磁盘 寻道方式都要加以改进。
